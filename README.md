# Детекция лица с предсказанием возраста, пола и этнической группы
Приложение детектирует лицо на видео, полученном с веб-камеры, и в онлайн режиме определяет пол, возраст и этническую принадлежность, выводя результаты на экран.

## Структура проекта
### Детекция лица
Кадры, полученные с веб-камеры сжимаются и переводятся в чёрно-белый цвет функциями библиотеки <b>cv2</b>. Полученный чёрно-белый кадр передаётся заранее предобученной на детекцию
лиц модели, икоторая использует каскады Хаара. 

### Классификация лиц
Детектируемое лицо вырезется из кадра и направляется для классификации в нейронную сеть, которая возвращает значения: возраст, этническая группа, пол.
Нейронная сеть состит из основной части (backbone) и трёх голов(heads), каждая из которых выводит соответсвующее значение для возраста, этнической группы и пола. Каждый выход
нейронной сети имеет свою структуру, обусловленную задачами цели. Первый выход имеет один выходной нейрон, возвращающий значение возраста. Второй выход возвращает 5 значений принадлежности к одному из пяти этносов. Третий выход вовзращает вероятность принадлежности к мужчине/женщине.

На стадии обучения каждому выходу соответствовали свои функции потерь, соответственно:
1. Среднеквадратическая ошибка
2. Кросс-энтропия
3. Бинарная кросс-энтропия

### Вывод результата
Кадры с выделенным лицом и результатами классификации выводятся на экран в постоянном режиме. 
Для демонстрации работы приложения нужно запустить launch_face_detection.py

## Файлы проекта
1. <b>model_structure.py</b> Содержит класс, определяющий архитектуру модели
2. <b>training.py</b> Загружает класс модели из  <b>model_structure.py</b>, обрабатывает данные из <b>data.csv</b> и обучает модель, сохраняя веса в файл <b>epoch30.pth</b>
3. <b>launch_face_detection.py</b> Загружает класс модели из <b>model_structure.py</b> и веса из <b>epoch30.pth</b>. Далее проводится детекция лиц и их классификация нейронной сетью. Результат выводится на экран в постоянном режиме.
4. <b>data.csv</b> - содержит данные, используемые для обучения и валидации

Для измерения точности модели использовались следующие метрики: MSE для значений возраста и Accuracy для значений пола и этнической принадлежности. В итоге, 30 эпох обучения показали следующий результат на валидационной выборке.

![alt text](https://raw.githubusercontent.com/MikhailKuzm/Face_detect/main/Accuracy.png)

![alt text](https://raw.githubusercontent.com/MikhailKuzm/Face_detect/main/MSE.png)

